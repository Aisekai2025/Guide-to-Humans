<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8"><title>図鑑リスト | Guide to Humans</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body { background-color: #0d1117; color: #e6edf3; }</style>
</head>
<body class="p-6 max-w-md mx-auto">
    <header class="mb-8 flex items-center justify-between">
        <button onclick="location.href='index.html'" class="text-emerald-400">← 戻る</button>
        <h2 class="text-xl font-bold">攻略済み個体リスト</h2>
    </header>

    <main id="collection-list" class="space-y-4">
        <!-- ここにリストが自動生成されますぞ -->
    </main>

   <script>
    // データの読み込み
    let collections = JSON.parse(localStorage.getItem('gth_collections') || '[]');
    const container = document.getElementById('collection-list');

    function renderList() {
        if (collections.length > 0) {
            container.innerHTML = ""; 
            
            collections.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = "bg-gray-800 p-4 rounded-xl border border-emerald-500/30 flex justify-between items-center mb-4";
                card.innerHTML = `
                    <div class="flex-1">
                        <div class="text-xs text-emerald-400 font-bold">${item.tag}</div>
                        <div class="text-lg font-bold">${item.nickname}</div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="reAnalyze(${index})" class="text-xs bg-emerald-600 px-3 py-1 rounded-full">再解析</button>
                        <button onclick="deleteEntry(${index})" class="text-xs bg-red-900/50 text-red-400 border border-red-500/30 px-3 py-1 rounded-full">消去</button>
                    </div>
                `;
                container.appendChild(card);
            });
        } else {
            container.innerHTML = "<p class='text-center text-gray-500 py-10'>まだ個体が登録されておりませんな。</p>";
        }
    }

    // 削除を実行する関数ですぞ
    function deleteEntry(index) {
        if (confirm("この個体の研究データを破棄しますか？")) {
            // 1. 指定した番号のデータを1件削除（splice）しますぞ
            collections.splice(index, 1);
            
            // 2. 削除後のリストを保存し直します
            localStorage.setItem('gth_collections', JSON.stringify(collections));
            
            // 3. 画面を書き直します
            renderList();
        }
    }

    function reAnalyze(index) {
        const target = collections[index];
        localStorage.setItem('gth_nickname', target.nickname);
        localStorage.setItem('gth_tag', target.tag);
        location.href = 'result.html';
    }

    // 最初にリストを表示
    renderList();
</script>
</body>
</html>
